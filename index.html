<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>E‚Äëshop s detekc√≠ oper√°tora</title>
  <style>
    /* Z√°kladn√≠ reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: #f5f5f5; color: #333; }
    header, footer { background: #004a99; color: white; padding: 1rem; text-align: center; }
    main { display: flex; flex-direction: column; align-items: center; padding: 2rem; }
    .products, .cart, .checkout { width: 100%; max-width: 800px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); margin-bottom: 2rem; padding: 1.5rem; display: none; }
    .products.active, .cart.active, .checkout.active { display: block; }
    .products .grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap: 1rem; }
    .product { border: 1px solid #ddd; border-radius: 6px; overflow: hidden; background: #fff; }
    .product img { width: 100%; height: 150px; object-fit: cover; }
    .product .info { padding: 0.5rem; }
    .product .info h3 { font-size: 1.1rem; margin-bottom: 0.5rem; }
    .product .info p { font-size: 0.9rem; margin-bottom: 0.5rem; }
    .product .info button { background: #0074d9; color: white; border: none; padding: 0.5rem; border-radius: 4px; cursor: pointer; }
    .cart table { width: 100%; border-collapse: collapse; margin-bottom: 1rem; }
    .cart th, .cart td { border: 1px solid #ddd; padding: 0.5rem; text-align: center; }
    .cart button, .checkout button { background: #0074d9; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 4px; cursor: pointer; }
    .checkout form { display: flex; flex-direction: column; gap: 1rem; }
    .checkout label { font-weight: bold; }
    .checkout input { padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; }
    #cornerIcon { position: fixed; top: 10px; right: 10px; font-size: 2rem; z-index: 1000; }
  </style>
</head>
<body>
  <header>
    <h1>Super E‚Äëshop</h1>
  </header>

  <main>
    <!-- Krok 1: V√Ωpis produkt≈Ø -->
    <section id="step-products" class="products active">
      <h2>Na≈°e produkty</h2>
      <div class="grid">
        <div class="product">
          <img src="https://via.placeholder.com/300x150?text=Produkt+1" alt="Produkt 1">
          <div class="info">
            <h3>Produkt 1</h3>
            <p>Skvƒõl√Ω v√Ωrobek za v√Ωhodnou cenu.</p>
            <button data-id="1" data-name="Produkt 1" data-price="499">P≈ôidat do ko≈°√≠ku</button>
          </div>
        </div>
        <div class="product">
          <img src="https://via.placeholder.com/300x150?text=Produkt+2" alt="Produkt 2">
          <div class="info">
            <h3>Produkt 2</h3>
            <p>Vysok√° kvalita a spolehlivost.</p>
            <button data-id="2" data-name="Produkt 2" data-price="1299">P≈ôidat do ko≈°√≠ku</button>
          </div>
        </div>
        <!-- Dal≈°√≠ produkty‚Ä¶ -->
      </div>
      <button id="to-cart">P≈ôej√≠t do ko≈°√≠ku</button>
    </section>

    <!-- Krok 2: Ko≈°√≠k -->
    <section id="step-cart" class="cart">
      <h2>V√°≈° ko≈°√≠k</h2>
      <table>
        <thead>
          <tr><th>Produkt</th><th>Cena</th><th>Mno≈æstv√≠</th><th>Akce</th></tr>
        </thead>
        <tbody id="cart-body">
          <!-- Napln√≠ se skriptem -->
        </tbody>
      </table>
      <p><strong>Celkem: </strong><span id="cart-total">0</span> Kƒç</p>
      <button id="to-checkout">Pokraƒçovat k platbƒõ</button>
      <button id="back-to-products">Zpƒõt na produkty</button>
    </section>

    <!-- Krok 3: Checkout -->
    <section id="step-checkout" class="checkout">
      <h2>Objedn√°vka ‚Äì Krok 1: √ödaje z√°kazn√≠ka</h2>
      <form id="checkout-form">
        <label for="name">Jm√©no a p≈ô√≠jmen√≠</label>
        <input type="text" id="name" required>
        <label for="email">E‚Äëmail</label>
        <input type="email" id="email" required>
        <label for="address">Adresa</label>
        <input type="text" id="address" required>
        <button type="submit">Dokonƒçit objedn√°vku</button>
      </form>
    </section>
  </main>

  <!-- Ikona detekce -->
  <div id="cornerIcon">‚ùî</div>

  <footer>
    &copy; 2025 Super E‚Äëshop
  </footer>

  <script>
    // === E‚Äëshop logika (ko≈°√≠k + v√≠cekrokov√Ω proces) ===
    const cart = {};
    const cartBody = document.getElementById('cart-body');
    const cartTotalEl = document.getElementById('cart-total');

    // p≈ôid√°n√≠ tlaƒç√≠tek
    document.querySelectorAll('.product button').forEach(btn => {
      btn.addEventListener('click', () => {
        const id    = btn.dataset.id;
        const name  = btn.dataset.name;
        const price = parseInt(btn.dataset.price, 10);
        cart[id] = cart[id] || { name, price, qty: 0 };
        cart[id].qty++;
        renderCart();
      });
    });
    function renderCart() {
      cartBody.innerHTML = '';
      let total = 0;
      for (let id in cart) {
        const item = cart[id];
        total += item.price * item.qty;
        cartBody.innerHTML += `
          <tr>
            <td>${item.name}</td>
            <td>${item.price} Kƒç</td>
            <td>${item.qty}</td>
            <td><button class="remove" data-id="${id}">√ó</button></td>
          </tr>`;
      }
      cartTotalEl.textContent = total;
      document.querySelectorAll('.remove').forEach(b => {
        b.addEventListener('click', () => {
          delete cart[b.dataset.id];
          renderCart();
        });
      });
    }

    // navigace mezi kroky
    document.getElementById('to-cart').addEventListener('click', () => {
      showStep('step-cart');
    });
    document.getElementById('back-to-products').addEventListener('click', () => {
      showStep('step-products');
    });
    document.getElementById('to-checkout').addEventListener('click', () => {
      showStep('step-checkout');
    });
    document.getElementById('checkout-form').addEventListener('submit', e => {
      e.preventDefault();
      alert('Dƒõkujeme za objedn√°vku!');
      location.reload();
    });

    function showStep(id) {
      ['step-products','step-cart','step-checkout']
        .forEach(s => document.getElementById(s).classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    // === Detekce ƒçlovƒõk vs. automat podle my≈°i ===
    const MAX_SAMPLES    = 300;
    let samples          = [];
    let lastTime         = 0;
    let tracking         = true;  // automaticky hned zaƒçneme sledovat

    // P≈ô√≠sn√© prahy pro spolehlivou detekci
    const PRAH_ROZPTYL   = 1000;  // n√≠zk√Ω rozptyl znamen√° automat
    const PRAH_UHEL      = 0.5;   // mal√° zmƒõna √∫hlu znamen√° automat

    const cornerIcon     = document.getElementById('cornerIcon');

    function computeFeatures(data) {
      const speeds = [], angles = [];
      for (let i = 1; i < data.length; i++) {
        const dx = data[i].x - data[i-1].x;
        const dy = data[i].y - data[i-1].y;
        const dt = (data[i].t - data[i-1].t) / 1000;
        speeds.push(Math.hypot(dx, dy) / (dt || 1e-6));
        angles.push(Math.atan2(dy, dx));
      }
      const meanSpeed = speeds.reduce((a,b)=>a+b,0)/speeds.length;
      const varSpeed  = speeds.reduce((a,b)=>a + Math.pow(b-meanSpeed,2),0)/speeds.length;
      const diffs     = [];
      for (let i = 1; i < angles.length; i++) {
        let d = Math.abs(angles[i] - angles[i-1]);
        if (d > Math.PI) d = 2*Math.PI - d;
        diffs.push(d);
      }
      const meanAngleChange = diffs.reduce((a,b)=>a+b,0)/diffs.length;
      return { varSpeed, meanAngleChange };
    }

    function updateDetection() {
      if (samples.length < 5) return;
      const f = computeFeatures(samples);
      const human = (f.varSpeed > PRAH_ROZPTYL && f.meanAngleChange > PRAH_UHEL);
      cornerIcon.textContent = human ? 'üñêÔ∏è' : 'ü§ñ';
    }

    window.addEventListener('mousemove', e => {
      if (!tracking) return;
      const now = Date.now();
      if (now - lastTime > 30) {
        samples.push({ x: e.clientX, y: e.clientY, t: now });
        lastTime = now;
        if (samples.length > MAX_SAMPLES) samples.shift();
        updateDetection();
      }
    });

    // Naƒçten√≠ str√°nky spust√≠ sledov√°n√≠ hned
    window.addEventListener('load', () => {
      cornerIcon.textContent = '‚åõ'; // indikace rozjezdu
      setTimeout(() => {
        // prvn√≠ vyhodnocen√≠ po 1s
        updateDetection();
      }, 1000);
    });
  </script>
</body>
</html>
